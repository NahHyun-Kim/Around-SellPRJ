<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- JAVA와 연결할 Mapper 파일 설정 -->
<mapper namespace="poly.persistance.mapper.IUserMapper">

    <!--회원 가입하기(회원정보 등록하기) -->
    <insert id="insertUser" parameterType="UserDTO">
        INSERT INTO aroundsell.user_info
            (
                USER_EMAIL,
                PASSWORD,
                USER_NAME,
                PHONE_NO,
                ADDR,
                ADDR2,
                REG_ID,
                CHG_ID
            )
            VALUES(
                #{user_email},
                #{password},
                #{user_name},
                #{phone_no},
                #{addr},
                #{addr2},
                #{user_name},
                #{user_name}
                  )
    </insert>

    <!--중복가입 방지를 위한 이메일 중복 확인 -->
    <select id="emailCheck" parameterType="UserDTO" resultType="UserDTO">
        SELECT
            USER_EMAIL
        FROM
            aroundsell.user_info
        WHERE
            USER_EMAIL = #{user_email}
    </select>

    <!-- 핸드폰 번호 중복 등록 방지를 위한 확인 -->
    <select id="phoneCheck" parameterType="UserDTO" resultType="UserDTO">
        SELECT
            PHONE_NO
        FROM
            aroundsell.user_info
        WHERE
            PHONE_NO = #{phone_no}
    </select>

    <!-- 로그인을 위해 이메일과 비밀번호가 일치하는지 확인 -->
    <select id="getLogin" parameterType="UserDTO" resultType="UserDTO">
        SELECT *
            FROM
               aroundsell.user_info
        WHERE USER_EMAIL = #{user_email}
            AND PASSWORD = #{password}
    </select>

    <!-- 관리자 페이지에서 회원 목록 조회 -->
    <select id="getUser" resultType="UserDTO">
        SELECT *
            FROM aroundsell.user_info
        WHERE <![CDATA[USER_NO > 0]]>
            ORDER BY REG_DT DESC,
                     USER_NO ASC
    </select>

    <!-- 회원 상세정보 조회 -->
    <select id="getUserDetail" parameterType="UserDTO" resultType="UserDTO">
        SELECT *
            FROM aroundsell.user_info
        WHERE USER_NO = #{user_no}
    </select>

    <!-- 관리자 권한으로 회원 탈퇴 -->
    <delete id="deleteForceUser" parameterType="UserDTO">
        DELETE
            FROM aroundsell.user_info
        WHERE USER_NO = ${user_no}
    </delete>

    <!-- 임시 비밀번호로 변경 -->
    <update id="updatePw" parameterType="UserDTO">
        UPDATE aroundsell.user_info
        SET
            PASSWORD = #{password}
        WHERE
            USER_EMAIL = #{user_email}
    </update>

    <!-- 마이페이지 회원 정보 수정 -->
    <update id="update">

    </update>



</mapper>